# RabbitMQ, AMQP, RPC

## –°—Å—ã–ª–∫–∏

1. RabbitMQ. –ß–∞—Å—Ç—å 1. Introduction. Erlang, AMQP (2020);

[RabbitMQ. –ß–∞—Å—Ç—å 1. Introduction. Erlang, AMQP](https://habr.com/ru/post/488654/)

1. RabbitMQ –ø—Ä–æ—Ç–∏–≤ Kafka: –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ –æ–±–º–µ–Ω—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ (2018).

[RabbitMQ –ø—Ä–æ—Ç–∏–≤ Kafka: –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ –æ–±–º–µ–Ω—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏](https://habr.com/ru/company/itsumma/blog/416629/)

## –ß—Ç–æ —Ç–∞–∫–æ–µ AMQP?

***AMQP*** - –æ—Ç–∫—Ä—ã—Ç—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –º–æ–≥—É—Ç –æ–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ ***AMQP-–±—Ä–æ–∫–µ—Ä***, –∫–æ—Ç–æ—Ä—ã–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É, –º–æ–∂–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É –¥–æ—Å—Ç–∞–≤–∫—É (–≤–æ–∑–º–æ–∂–Ω–æ), —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –Ω—É–∂–Ω—ã–π —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏–π.

***Exchange*** - —Ç–æ—á–∫–∞ –æ–±–º–µ–Ω–∞, –≤ –Ω–µ–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è. –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—á–µ—Ä–µ–¥–µ–π.

***Queue*** - –æ—á–µ—Ä–µ–¥—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –æ—Ç–¥–∞–µ—Ç –∫–æ–ø–∏–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º. –û–¥–Ω–∞ –æ—á–µ—Ä–µ–¥—å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º–∏.

***Billing*** - –ø—Ä–∞–≤–∏–ª–∞, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–æ–±—â–∞–µ—Ç —Ç–æ—á–∫–µ –æ–±–º–µ–Ω–∞ –≤ –∫–∞–∫—É—é –∏–∑ –æ—á–µ—Ä–µ–¥–µ–π —ç—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø–æ–ø–∞–¥–∞—Ç—å.

![6f47e92a8d4ebca0e828abd0970596e9.jpg](RabbitMQ,%20AMQP,%20RPC%206cfb8a8d805f43ebaafa9e9cbf3eead6/6f47e92a8d4ebca0e828abd0970596e9.jpg)

## RabbitMQ

***RabbitMQ*** - –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ AMQP.

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –º–æ–¥–µ–ª–∏ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ - ***producer*** (–∏–∑–¥–∞—Ç–µ–ª—å) –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –æ—á–µ—Ä–µ–¥—å. –ò–∑–¥–∞—Ç–µ–ª—å —á–∞—Å—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç, –±—É–¥–µ—Ç –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ –≤ –∫–∞–∫—É—é-–ª–∏–±–æ –æ—á–µ—Ä–µ–¥—å. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏–∑–¥–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–±–º–µ–Ω, –≥–¥–µ —Å–∞–º –æ–±–º–µ–Ω –∑–Ω–∞–µ—Ç, —á—Ç–æ —Å –Ω–∏–º –¥–µ–ª–∞—Ç—å.

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã RabbitMQ

1. –ò–∑–¥–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –æ–±–º–µ–Ω–Ω–∏–∫ (***exchange***);
2. ***Exchange***, –ø–æ–ª—É—á–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ –≤ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—á–µ—Ä–µ–¥–µ–π
(***queue***);
3. ***Queue*** —Ö—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ;
4. –ö–∞–∫ —Ç–æ–ª—å–∫–æ consumer –≥–æ—Ç–æ–≤ –ø–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, —Å–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞—ë—Ç –∫–æ–ø–∏—é —Å–æ–æ–±—â–µ–Ω–∏—è
–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–º—É;
5. ***Consumer*** –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ;
6. ***Broker***, –ø–æ–ª—É—á–∏–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —É–¥–∞–ª—è–µ—Ç –∫–æ–ø–∏—é —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Å–∞–º–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑
–ø–∞–º—è—Ç–∏.

![1e8006fbb2212da5d284f246fa0f64bc.png](RabbitMQ,%20AMQP,%20RPC%206cfb8a8d805f43ebaafa9e9cbf3eead6/1e8006fbb2212da5d284f246fa0f64bc.png)

### RPC (Remote procedure call)

–î–ª—è –æ–±–º–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–∞–Ω–∞–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

![e8lrjjvfhlx_bnd4lusfntmukmo.jpeg](RabbitMQ,%20AMQP,%20RPC%206cfb8a8d805f43ebaafa9e9cbf3eead6/e8lrjjvfhlx_bnd4lusfntmukmo.jpeg)

–ö–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç –¥—Ä—É–≥–æ–≥–æ, –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É, –Ω–µ –ø–æ–ª—É—á–∏–≤ –æ—Ç–≤–µ—Ç.

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª–æ–≤, —á—Ç–æ –Ω–µ–ø–ª–æ—Ö–æ –∑–∞–Ω–∏–º–∞–µ—Ç –ø–∞–º—è—Ç—å, —Ç–∞–∫ –∫–∞–∫ –∫–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª - –æ—Ç–¥–µ–ª—å–Ω—ã–π **Erlang** –ø—Ä–æ—Ü–µ—Å—Å. –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–∞–Ω–∞–ª–∞ –Ω–∞ –∫–∞–∂–¥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é —Ç–æ–∂–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –±–æ–ª—å—à–∏–º –∑–∞—Ç—Ä–∞—Ç–∞–º.

–ü–æ—ç—Ç–æ–º—É —á–µ–º –±–æ–ª—å—à–µ –∫–∞–Ω–∞–ª–æ–≤ –∏–º–µ–µ—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, —Ç–µ–º¬†**–±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç RabbitMQ** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∞–∫–∏–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º.

<aside>
‚ö†Ô∏è –û—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ¬†**–ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –±–æ–ª—å—à–∏–º –∑–∞—Ç—Ä–∞—Ç–∞–º**.

</aside>

–ö–∞–Ω–∞–ª—ã —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º–∏, –Ω–æ –º–Ω–æ–≥–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –∑–∞–∫—Ä—ã—Ç–∏—é –∫–∞–Ω–∞–ª–∞, –ø–æ—ç—Ç–æ–º—É —Å—Ä–æ–∫ —Å–ª—É–∂–±—ã –∫–∞–Ω–∞–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ—Ä–æ—á–µ, —á–µ–º —É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

![iqneq-_gmg-yq8bkk2-3_-mkvky.jpeg](RabbitMQ,%20AMQP,%20RPC%206cfb8a8d805f43ebaafa9e9cbf3eead6/iqneq-_gmg-yq8bkk2-3_-mkvky.jpeg)

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è RabbitMQ?

–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–æ—Ç–æ–∫–æ–ª¬†**AMQP** –∏ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤¬†**RabbitMQ** —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è¬†**–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è**¬†–º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.

–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ¬†**IIOT** –ø—Ä–æ—Ç–æ–∫–æ–ª¬†**AMQP** –∏ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤¬†RabbitMQ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏ (—Å–µ—Ä–≤–µ—Ä-—Å–µ—Ä–≤–µ—Ä). –¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–ª–∞–≥–∏–Ω¬†[MQTT Plugin RabbitMQ](https://www.rabbitmq.com/mqtt.html) —è–≤–ª—è—é—â–µ–≥–æ—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª–∞¬†[MQTT](https://ru.wikipedia.org/wiki/MQTT) ¬†–¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º –≤ –Ω–∏–∑–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö —Å –≤—ã—Å–æ–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π.

### Exchange

***Exchange*** - –æ–±–º–µ–Ω–Ω–∏–∫ –∏–ª–∏ —Ç–æ—á–∫–∞ –æ–±–º–µ–Ω–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è. –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—á–µ—Ä–µ–¥–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö ***billing***.

<aside>
üí° –ù–µ —è–≤–ª—è–µ—Ç—Å—è ***Erlang*** –ø—Ä–æ—Ü–µ—Å—Å–æ–º. 1 —Ç—ã—Å—è—á–∞ ***Exchange*** –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –≤—Å–µ–≥–æ 1–ú–± –ø–∞–º—è—Ç–∏.

</aside>